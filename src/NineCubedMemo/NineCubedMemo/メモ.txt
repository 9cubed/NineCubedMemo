
■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■

  独り言によるメモ帳作成講座

■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■

▼更新履歴

■ver1.1.8 (2018-12-24)
 1. 画像ビューアープラグインを追加しました。
 2. ファイルリストで、ATL+上下キーにより、同じ階層の隣のフォルダへ移動できるようにしました。

■ver1.1.7 (2018-12-17)
 1. 起動時の PluginLoader で、受け取る親のプラグインを指定した場合、PluginCreatedイベントを発生するようにしました。
    また、PluginCreated イベントを受け取らないプラグインには、割り当てられないようになります。
 2. 検索フォームをプラグイン化しました。
    検索入力欄のデータは、PluginManager にプラグイン間で使える共通データとして保持して、
    テキストエディタープラグインもその値を見て検索するように変更しました。
 3. フォームのツールバーとメニューを全てプラグイン化しました。
 4. テキストエディターを上下分割できるようにしました。
    但し、上部は参照のみで、編集は下部でのみ可能。
 5. テキストエディターに見出しリストを追加しました。
 6. メニューに「最新の情報に更新」を追加。
    これに伴い、ファイルリストで、F5を押した時に、最新の情報になるようにしました。
 7. 文字列や画像をコピーしてファイルリストでペーストをすると、ファイルを作成するようにしました。

■ver1.1.6 (2018-12-07)
 1. キーボードマクロのショートカットをF1、F2から、F9、F10に変更しました。ファイルリストで、F2でファイル名を変更できるようにするため、
 2. ファイルリストの変更
    1. ファイル名、拡張子、更新日時を変更できるようにしました。これに伴い、行選択からセル選択に変更しました。
       注意：エクスプローラーを開いていると、変更できない場合があります。
    2. 文字コード指定や、バイナリーモードで開けるようにしました。
    3. ファイルとフォルダの新規作成をできるようにしました。
    4. ファイルサイズに、GB、MBなどの単位を表示するようにしました。

■ver1.1.5 (2018-11-27)
 1. PluginLoader による起動時のプラグイン生成時に、dock と 受け取る親のプラグインを指定できるようにしました。
    但し、スプリットコンテナーはパネルを２枚保持するため、親指定は不可。
    パネルプラグインを2枚割り当てて、そのパネルを親として指定することにより割り当てます。
 2. レイアウト用にPanelプラグインを追加しました。
 3. PathFieldプラグインを追加しました。
 4. AppConfigを廃止して、各プラグインの data フォルダ配下の、
    プロパティファイル(property.ini)を使用するように変更しました。
    プロパティファイルは、Initialize() で読み込み、 ClosePlugin() で保存します。

■ver1.1.4 (2018-11-15)
 1. プラグイン対応
    1. 外部の dll に含まれるプラグインを動的に生成できるようにしました。
    2. フォームを含む主要なコントロールは全てプラグイン化して、
       全て動的に生成するようにしました。
    3. EXE起動時は、
       生成するプラグインを定義したリスト(plugin_list.ini)を元にして
       プラグインローダーで生成するようにしました。
       リストを変更することで、画面の配置変更も可能です。
 2. 新しいタプルを使うため、ターゲットフレームワークを、
    .NET Framework 4.7.1 にしました。
    StringUtils.GetKeyValue() で使用
 3. ファイルリストでファイルの画像を表示するようにしました。
 4. ファイルツリーとファイルリストに、最新の情報に更新する機能を追加しました。

■ver1.1.3 (2018-11-05)
 1. ファイルリストを追加しました。
 2. プラグインローダープラグインを追加しました。
    メニューの開く、ツールバーの開く、ファイルリストのファイル選択時に発生したファイル選択イベントを受け取り、
    拡張子に対応するプラグインを生成します。
 3. ファイルオープン・プラグイン生成・タブに追加までの流れを変更しました。

■ver1.1.2 (2018-10-28)
 1. ファイルツリーを追加しました。

■ver1.1.1 (2018-10-08)
 1. プラグイン間の独自イベント処理を行うためのイベントマネージャーを追加しました。
    発生したイベント名と同じ名前のメソッドをリフレクションで実行します。
 2. ファイルオープン・プラグイン生成・タブに追加までの流れを変更しました。
 3. configファイルのパスが相対パスになっていたため、EXEの場所を見るように変更しました。

■ver1.1.0 (2018-09-01)
 1. メモ帳のプラグイン化
    今後のタブ化のため、フォームからテキストボックスを削除して、
    プラグイン化したテキストエディターを動的に生成するように変更。
 2. 新規作成機能の廃止
    今後はファイル一覧を表示して、そこでファイルを作成しておいてから開くようにする。
    これにより、パスが未確定のままメモ帳が開かれることがなくなり、
    「無題」で上書き保存された時に、名前を付けて保存を実行する処理が不要になる。
 3. ステータスバーの追加
    フォームのタイトルにパスを表示していたが、ステータスバーに表示ように変更した。

■ver1.0.12 (2018-08-16)
 1. ファイルをバイナリ形式で開く機能の追加
 2. ポップアップメニューに、文字コード(16進数)と文字列の変換機能の追加
 3. ポップアップメニューに、10進数と16進数の変換機能の追加

■ver1.0.11 (2018-08-09)
 1. キー操作の記録と再生機能の追加。但し、以下の不具合があります。

  [不具合]
   1. 「^」を記憶して再生すると「&」になってしまうため、今は全角の「＾」に置換して出力している。
   2. キー操作の再生中にキーを入力できてしまう。
      例えば、Shiftを押しながら再生させると、全てのキーがShiftを押した状態で出力されてしまう。

■ver1.0.10 (2018-07-23)
 1. 選択した数式を計算する機能の追加。doubleで計算しているため誤差あり。

■ver1.0.9 (2018-06-27)
 1. TABキーによるインデント変更機能の追加。
 2. 書式付きの文字列をコピーしてる場合、書式付きでペーストされるため、
    テキストフォーマットにペーストされるように変更。
 3. クリップボードの画像の保存機能の追加。
 4. F12キーにより、画像のプレビュー表示機能の追加。
 5. フォームのアイコンを変更

■ver1.0.8 (2018-06-13)
 1. RichTextBoxを継承して独自テキストボックスを追加
    初期化処理などは独自テキストボックス側で行うように修正。
 2. ファイルのドラッグ＆ドロップ対応
    エクスプローラーからファイルをドラッグ＆ドロップしてファイルを開けるようにしました。
 3. ポップアップメニューに小文字・大文字変換、半角・全角変換機能を追加しました。
 4. メニューにショートカットキーを追加しました。新規作成(Ctrl+N)、開く(Ctrl+O)、保存(Ctrl+S)。
 5. テキストボックスのフォント名、フォントサイズを Config に追加しました。
 6. 検索用I/F(ISearchString)の引数を削除。
    検索条件はターゲット側に持たせて、検索画面からは引数を渡さずに、指示を出すだけにしました。

■ver1.0.7 (2018-05-24)
 1. 検索・置換機能の追加
    1. 検索・置換メニューの追加
    2. 検索・置換画面の追加
 2. MainForm側の処理を軽くするため、Configファイルの読込、保存、Formへの反映処理を、全てAppConfigクラス側で行うように修正しました。

■ver1.0.6 (2018-05-15)
 1. オブジェクトをXMLに変換する SerializeUtilsクラスを追加しました。
 2. フォームを前回開いていた位置とサイズで表示するようにしました。
 3. 読み取り専用ファイルがあると、テスト実行後にTestResults配下のテストフォルダが残るため、
    TextFileTests.LoadTest() で読み取り専用を解除するようにしました。
 4. ポップアップメニュー(右クリックメニュー)により、切り取り、コピー、貼り付けが行えるようにしました。
 5. コマンドライン引数により最初に開くファイルを指定できるようにしました。
    指定方法
     1. EXEにファイルをドラッグ&ドロップ
     2. 送るメニューによりファイルを指定(送るフォルダにEXEを配置する必要がある。shell:sendto)
     3. ショートカットの引数により指定

■ver1.0.5 (2018-05-06)
 1. 単体テストの追加。
 2. TextFileクラスのLoad()の修正。
    文字コードの判別のため、最初にファイルを全て読み込んでバイト配列に入れ、
    そこから ReadLine() で1行ずつ読み込み、\n で Join して文字列にしていたが、
    ReadToEnd() で全て文字列に読み込んでから改行コードを \n に置換した方が速かったため、ReadToEnd() を使うようにした。
    また、文字コードと改行コードが指定されていない場合のみ、自動判別するようにした。
 3. メニューのファイルに、文字コードと改行コードを指定するメニューを追加。
 4. メニューのファイルに、文字コードを指定して開くメニューを追加。

■ver1.0.4 (2018-04-29)
 1. テキストファイルを表すTextFileクラスの追加。
    パスや読み込み専用のフラグを保持する。
    また、文字コード、改行コード(CRLF、CRのみ、LFのみ)を指定してファイルを保存できるようにした。
 2. TextFileクラスの追加に伴い、Formで保持していたパス、読み込み専用のフラグを TextFileクラスで保持するように修正。
    また、RichTextBoxのメソッドで行っていたファイルの入出力を、TextFileクラスで行うようにした。
 3. フォームのタイトルに、開いているファイルの文字コード、BOMの有無を表示するようにした。
 4. __クラスの追加。デバッグ用やよく使うメソッドを入れる予定。

■ver1.0.3 (2018-04-20)
 1. ツールバーに「新規作成」「開く」「上書き保存」を追加。
 2. フォームタイトルにパス、読み取り専用のマーク、編集ありのマークを表示するようにした。
 3. テキストボックスの左の内側の余白の再設定。テキストを全て削除すると、余白が消えるため。

■ver1.0.2 (2018-04-17)
 1. ソースの整理
 2. メッセージボックスで「キャンセル」が選択された時は、独自実装の CancelException をスローするようにした。
 3. 各メニューのクリックイベントを try ～ catch でエラーを吸収するようにした。

■ver1.0.1 (2018-04-07)
 1. メニューの「新規作成」「開く」「上書き保存」「名前を付けて保存」の実装。

■ver1.0.0 (2018-04-04)
 1. RichTextBox、メニュー、ツールバーの配置。
 2. RichTextBox の初期化

以上
